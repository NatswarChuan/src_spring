<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head th:replace="common/head :: head_fragment(title = 'クラス情報登録', scripts = ~{::script}, links = ~{::link})"></head>

<body>
	<div class="container">

		<h1>クラス情報登録</h1>

		<div th:if="${validationError}" th:each="error : ${validationError}">
			<label class="text-danger" th:text="${error}"></label>
		</div>

		<div class="w-50">
			<form id="my-form" th:action="@{/mstClass/edit}" th:object="${mstClass}" th:method="post">
				<div class="form-group">
					<label>クラスID<span class="text-danger">※</span></label> <input value="*{classId}" type="text"
						th:field="*{classId}" class="form-control" disabled /> <input type="hidden" th:value="*{classId}"
						th:attr="name='classId'" />
				</div>
				<div class="form-group">
					<label>クラス名<span class="text-danger">※</span></label> <input value="*{className}" type="text"
						th:field="*{className}" class="form-control" />
				</div>

				<br />
				<div class="form-group">
					<label>クラス状態<span class="text-danger">※</span></label>
					<div class="radio" th:each="item : ${radioItems}">
						<label> <input type="radio" name="fradio" th:value="${item.value}" th:text="${item.key}"
								th:field="*{dataStatus}"></input>
						</label>
					</div>
				</div>
				<div class="text-left">
					<a href="/mstClass/list" class="btn btn-secondary m-3">戻る</a> <input type="submit" value="更新"
						class="btn btn-primary" onclick="submitButtonUpdateClick(event)"> <input type="submit" value="削除"
						class="btn btn-danger" onclick="submitButtonDeleteClick(event)">
				</div>
				<table th:attr="class=${mstClass.dataStatus == 0 ? 'table table-striped bg-dark' : 'table table-striped'}"
					id="table">
					<thead>
						<tr>
							<th>ss</th>
							<th>ID</th>
							<th>名前</th>
							<th>性的</th>
							<th>年齢</th>
							<th>データ状態</th>
							<th>登録日時</th>
							<th>更新日時</th>
							<!-- <th></th> -->
						</tr>
					</thead>
					<tbody>

						<tr th:each="studentItem, st : ${listMstStudent.dataList}"
							th:attr="class=${studentItem.dataStatus == 0 ? 'align-middle bg-dark' : 'align-middle'}">
							<td><input class="checkbox" type="checkbox"
									th:attr="disabled=${ studentItem.dataStatus == 0  ? 'true': 'false'}"
									th:name="${studentsOfClassResponse.studentsListId}" 
									th:value="${studentItem.studentId}"
									th:field="${studentsOfClassResponse.studentsListId}"></td>
							<td th:text="${studentItem.studentId}"></td>
							
							<td th:text="${studentItem.studentName}"></td>
							<td th:text="${studentItem.studentSex}"></td>
							<td th:text="${studentItem.studentAge}"></td>
							<td th:text="${studentItem.dataStatus}"></td>
							<td th:text="${#dates.format(studentItem.registeredDate, 'yyyy/MM/dd HH:mm:ss')}">
							<td th:text="${#dates.format(studentItem.updatedDate, 'yyyy/MM/dd HH:mm:ss')}">
						</tr>

					</tbody>
				</table>

			</form>
		</div>
	</div>
	<script>
						const checkboxs = document.querySelectorAll(".checkbox");
		const table = document.getElementById("table");
		$('input[type="radio"]').on(
			'click change',
			function (e) {
				e.currentTarget.value == 0 ? table.classList
					.add('bg-dark') : table.classList
						.remove('bg-dark');
						
				e.currentTarget.value == 0 ? (
					() => {
						checkboxs.forEach(element => {
							element.setAttribute("disabled", true);
						});
					}
				)() :
					(
						() => {
							checkboxs.forEach(element => {
								element.removeAttribute("disabled");;
							}
							)
						})()
			});

		function submitButtonUpdateClick(event) {
			const check = confirm("クラス情報を更新します。よろしいですか。");
			if (!check) {
				event.preventDefault();
			}
		}

		function submitButtonDeleteClick(event) {
			const check = confirm("クラス情報を削除します。よろしいですか。");
			if (!check) {
				event.preventDefault();
			}
			document.getElementById('my-form').action = "/mstClass/delete";
		}
	</script>
</body>

</html>